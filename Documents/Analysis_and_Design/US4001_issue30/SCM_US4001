@startuml
scale 1280*720

SCM -> OpenMessagesFiles : create()
activate OpenMessagesFiles
SCM -> OpenMessagesFiles : run()

OpenMessagesFiles -> OpenMessagesFiles : sock = new ServerSocket()
OpenMessagesFiles -> OpenMessagesFiles : cliSock = sock.accept()

OpenMessagesFiles -> ImportMessages : create()
activate ImportMessages
OpenMessagesFiles -> ImportMessages : run()

control MessageController
ImportMessages -> MessageController : create
activate MessageController
ImportMessages -> MessageController : registMessage(origin, creationDate)


MessageController -> PersistenceContext : repositories()


database RepositoryFactory #lightblue
PersistenceContext -> RepositoryFactory : create()
database MessageRepository #lightblue
RepositoryFactory -> MessageRepository : create()

MessageController -> Message : newMessage = create(origin, creationDate)


MessageController -> MessageRepository : save(newMessage)
deactivate MessageController
@enduml
